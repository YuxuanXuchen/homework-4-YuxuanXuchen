<!DOCTYPE html>
<html>
<body>

<p style="font-family: Arial; text-align: center;">Enter URL for Container Shipping Companies List JSON File</p>
<p style="text-align: center;"><input type="text" name="URL" id="myText"/></p>
<p style="text-align: center;"><input type="button" name="submit" value="submit" onclick="viewJSON()" /></p>

<script  type="text/javascript">

function loadJSON(url) {
      if (window.XMLHttpRequest)
      {// code for IE7+, Firefox, Chrome, Opera, Safari
       xmlhttp=new XMLHttpRequest();
   	} else {// code for IE6, IE5
    xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");  }



  	xmlhttp.open("GET",url,false); 
  	xmlhttp.overrideMimeType("application/json");

try {
  xmlhttp.send();
} catch(exception) {
  if(exception.name=='NetworkError') {
    alert('This file does not exist, please try again.');
  }
}
    //xmlhttp.send();

  	jsonObj= JSON.parse(xmlhttp.responseText);
  	return jsonObj;



  	}


	function viewJSON(){
	var URL=document.getElementById("myText").value;
	
	//var URL="containerlist.json";
  	jsonObj = loadJSON(URL);
 	if (window.ActiveXObject) //if IE, simply execute script (due to async prop).
 	{  
 		if (jsonObj.parseError.errorCode != 0) {
    		var myErr = jsonObj.parseError;
    		generateError(jsonObj);
    		hWin = window.open("", "Error", "height=300,width=340");
    		hWin.document.write(html_text);
    		hWin.document.close(); 
  		}else{  
  			displayFunction(jsonObj);
            
        } 
	}else{  
		jsonObj.onload=displayFunction(jsonObj);
    	
    } 
    	 
	}

function displayFunction(obj){
	//var obj=loadJSON();
	if(obj==null){
		window.alert("Invalid URL");
		return;
	}

	var m=obj.Mainline.Table.Row;
	var n=obj.Mainline.Table.Header.Data;
	if (m==null || m.length==0) 
		{window.alert("The provided json file is empty!");}
	else{
		var myWindow = window.open("", "");
	txt= "<table border='1'><tr>";
	var k;
	for(k=0;k<n.length;k++){
		txt+="<th>"+n[k]+"</th>";
	}
	txt+="</tr>";
	//txt+="<tr><th>Company</th><th>Number of Ships</th><th>HQ/Info</th><th>Market Share</th><th>HomePage</th> <th>Logo</th></tr>";
	var i;
	var j;
	for(i=0;i<m.length;i++){
		txt += "<tr>";
		txt += "<td>" + m[i].Company+ "</td>";
		txt += "<td>" + m[i].Ships+ "</td>";
		//use a list to display hubs
		txt+="<td><ul>";
		for(j=0;j<m[i].Hubs.Hub.length;j++){
		if(j==0)
			txt+="<li><strong>"+m[i].Hubs.Hub[j]+"</strong></li>";
		else
			txt+="<li>"+m[i].Hubs.Hub[j]+"</li>";
		}
		txt+="</ul></td>";	
		//here comes the market	
		txt += "<td>" + m[i].Market+ "</td>";
		txt += "<td><a href="+ m[i].HomePage+ ">"+m[i].HomePage+"</a></td>";
		txt += "<td><img width=450 height=300 src=" + m[i].Logo+ "></td>";
		txt+="</tr>";
	}
    
    txt += "</table>";

    myWindow.document.write(txt);
	}
	
}


</script>

</body>
</html>
